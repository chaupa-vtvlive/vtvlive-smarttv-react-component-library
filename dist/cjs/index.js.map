{"version":3,"file":"index.js","sources":["../../src/components/Button/Button.tsx","../../src/services/backService.ts","../../src/services/onPopout.ts","../../src/services/keyService.ts"],"sourcesContent":["import React from 'react'\r\n\r\nexport interface ButtonProps {\r\n  label: string\r\n}\r\n\r\nconst Button = (props: ButtonProps) => {\r\n  return <button>{props.label}</button>\r\n}\r\n\r\nexport default Button","type Handler = () => void;\r\n\r\nclass BackServices {\r\n  private static instance: BackServices;\r\n  handlers: Handler[] = [];\r\n  defaultHandle: Handler = () => {\r\n    window.history.back();\r\n  };\r\n  public static getInstance(): BackServices {\r\n    if (!BackServices.instance) {\r\n      BackServices.instance = new BackServices();\r\n    }\r\n    return BackServices.instance;\r\n  }\r\n\r\n  public back = () => {\r\n    const index = this.handlers.length - 1;\r\n    if (\r\n      index < 0 ||\r\n      !this.handlers[index] ||\r\n      typeof this.handlers[index] !== \"function\"\r\n    ) {\r\n      this.defaultHandle();\r\n    } else {\r\n      this.handlers[index]();\r\n    }\r\n  };\r\n\r\n  public register = (handler: Handler) => {\r\n    this.handlers.push(handler);\r\n  };\r\n\r\n  public unregister = (handler: Handler) => {\r\n    this.handlers.splice(this.handlers.indexOf(handler), 1);\r\n  };\r\n}\r\n\r\nexport default BackServices.getInstance();\r\n","export type Direct = {\r\n  up?: number;\r\n  left?: number;\r\n  right?: number;\r\n  down?: number;\r\n};\r\n\r\ntype Direction = \"up\" | \"left\" | \"right\" | \"down\";\r\n\r\ntype PopoutHandler = (_I: Direction) => void;\r\n\r\nexport default function onPopoutFactory(\r\n  setFocusFn: React.Dispatch<React.SetStateAction<number>>,\r\n  directionOpt: Direct,\r\n  forwardPopoutFn?: PopoutHandler\r\n): PopoutHandler {\r\n  return (direction: Direction) => {\r\n    if (\r\n      typeof directionOpt[direction] === \"number\" &&\r\n      directionOpt[direction]! >= 0\r\n    ) {\r\n      setFocusFn(directionOpt[direction]!);\r\n      return;\r\n    }\r\n    if (forwardPopoutFn && typeof forwardPopoutFn === \"function\") {\r\n      forwardPopoutFn(direction);\r\n      return;\r\n    }\r\n  };\r\n}\r\n","type KeyHandler = (e: KeyboardEvent) => void;\r\n\r\nexport default class KeyServices {\r\n  defaultHandle: KeyHandler = () => {};\r\n  registers: { [key: string]: KeyHandler } = {};\r\n  priorities: { currentHandle?: KeyHandler; handles: KeyHandler[] }[] = [];\r\n\r\n  private static instance: KeyServices;\r\n\r\n  private constructor() {\r\n    window.addEventListener(\"keydown\", this.keyHandle);\r\n  }\r\n\r\n  public static getInstance(): KeyServices {\r\n    if (!KeyServices.instance) {\r\n      KeyServices.instance = new KeyServices();\r\n    }\r\n    return KeyServices.instance;\r\n  }\r\n\r\n  private keyHandle = (e: KeyboardEvent) => {\r\n    const { registers, priorities } = this;\r\n    for (let k in registers) {\r\n      registers[k](e);\r\n    }\r\n    for (let i = 0; i < priorities.length; i++) {\r\n      if (priorities[i] && priorities[i].currentHandle) {\r\n        priorities[i].currentHandle!(e);\r\n        break;\r\n      }\r\n    }\r\n    if (!(e.keyCode > 111 && e.keyCode < 124)) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    }\r\n  };\r\n  public regHandler(id: string, keyHandle: KeyHandler) {\r\n    this.registers[id] = keyHandle;\r\n  }\r\n  public unregHandler(id: string) {\r\n    delete this.registers[id];\r\n  }\r\n  public clearRegisters() {\r\n    this.registers = {};\r\n  }\r\n\r\n  public pushHandle = (priority: number, keyHandle: KeyHandler) => {\r\n    const { priorities } = this;\r\n    if (priorities[priority]) {\r\n      priorities[priority].currentHandle = keyHandle;\r\n      priorities[priority].handles.push(keyHandle);\r\n    } else {\r\n      priorities[priority] = {\r\n        currentHandle: keyHandle,\r\n        handles: [keyHandle],\r\n      };\r\n    }\r\n  };\r\n\r\n  public popHandle = (priority: number, keyHandle: KeyHandler) => {\r\n    const { priorities } = this;\r\n    var p = priorities[priority];\r\n    if (p) {\r\n      if (keyHandle) {\r\n        const keyHandlerIndex = p.handles.indexOf(keyHandle);\r\n        if (keyHandlerIndex >= 0) {\r\n          p.handles.splice(keyHandlerIndex, 1);\r\n        }\r\n      }\r\n      p.currentHandle = p.handles.slice(-1)[0];\r\n    }\r\n  };\r\n\r\n  public switchHandle = (priority: number, keyHandle: KeyHandler) => {\r\n    const { priorities } = this;\r\n    if (priorities[priority]) {\r\n      priorities[priority].currentHandle = keyHandle;\r\n    } else {\r\n      priorities[priority] = {\r\n        currentHandle: keyHandle,\r\n        handles: [],\r\n      };\r\n    }\r\n  };\r\n\r\n  public stopHandle = (priority: number) => {\r\n    this.switchHandle(priority, this.defaultHandle);\r\n  };\r\n}\r\n"],"names":["Button","_0x301440","React","BackServices","_0x516630","_0x1bd835","window","_0x29da95","_0x508842","_0x3e1c3f","backService","onPopoutFactory","_0x192345","_0x5a6012","_0x13cb5f","_0x222ef9","KeyServices","_0x138960","_0xf84e1f","_0x53e26e","_0x3d487f","_0x2799b4","_0x23e81f","_0x185617","_0x5688bb","_0x31284c","_0x3baf41","_0x5d0d7b","_0x5946fe","_0x5a8b5c","_0x47b2c0","_0x5e0b02","_0x154159","_0x1156e2","_0xd1f4dd","_0x34f9c0","_0x1543c0","_0xce052c","_0x182744","_0x1f959f"],"mappings":"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"}