{"version":3,"file":"index.js","sources":["../../src/components/Button/Button.tsx","../../src/services/backService.ts","../../src/services/onPopout.ts","../../src/services/keyService.ts"],"sourcesContent":["import React from 'react'\r\n\r\nexport interface ButtonProps {\r\n  label: string\r\n}\r\n\r\nconst Button = (props: ButtonProps) => {\r\n  return <button>{props.label}</button>\r\n}\r\n\r\nexport default Button","type Handler = () => void;\r\n\r\nclass BackServices {\r\n  private static instance: BackServices;\r\n  handlers: Handler[] = [];\r\n  defaultHandle: Handler = () => {\r\n    window.history.back();\r\n  };\r\n  public static getInstance(): BackServices {\r\n    if (!BackServices.instance) {\r\n      BackServices.instance = new BackServices();\r\n    }\r\n    return BackServices.instance;\r\n  }\r\n\r\n  public back = () => {\r\n    const index = this.handlers.length - 1;\r\n    if (\r\n      index < 0 ||\r\n      !this.handlers[index] ||\r\n      typeof this.handlers[index] !== \"function\"\r\n    ) {\r\n      this.defaultHandle();\r\n    } else {\r\n      this.handlers[index]();\r\n    }\r\n  };\r\n\r\n  public register = (handler: Handler) => {\r\n    this.handlers.push(handler);\r\n  };\r\n\r\n  public unregister = (handler: Handler) => {\r\n    this.handlers.splice(this.handlers.indexOf(handler), 1);\r\n  };\r\n}\r\n\r\nexport default BackServices.getInstance();\r\n","export type Direct = {\r\n  up?: number;\r\n  left?: number;\r\n  right?: number;\r\n  down?: number;\r\n};\r\n\r\ntype Direction = \"up\" | \"left\" | \"right\" | \"down\";\r\n\r\ntype PopoutHandler = (_I: Direction) => void;\r\n\r\nexport default function onPopoutFactory(\r\n  setFocusFn: React.Dispatch<React.SetStateAction<number>>,\r\n  directionOpt: Direct,\r\n  forwardPopoutFn?: PopoutHandler\r\n): PopoutHandler {\r\n  return (direction: Direction) => {\r\n    if (\r\n      typeof directionOpt[direction] === \"number\" &&\r\n      directionOpt[direction]! >= 0\r\n    ) {\r\n      setFocusFn(directionOpt[direction]!);\r\n      return;\r\n    }\r\n    if (forwardPopoutFn && typeof forwardPopoutFn === \"function\") {\r\n      forwardPopoutFn(direction);\r\n      return;\r\n    }\r\n  };\r\n}\r\n","type KeyHandler = (e: KeyboardEvent) => void;\r\n\r\nexport default class KeyServices {\r\n  defaultHandle: KeyHandler = () => {};\r\n  registers: { [key: string]: KeyHandler } = {};\r\n  priorities: { currentHandle?: KeyHandler; handles: KeyHandler[] }[] = [];\r\n\r\n  private static instance: KeyServices;\r\n\r\n  private constructor() {\r\n    window.addEventListener(\"keydown\", this.keyHandle);\r\n  }\r\n\r\n  public static getInstance(): KeyServices {\r\n    if (!KeyServices.instance) {\r\n      KeyServices.instance = new KeyServices();\r\n    }\r\n    return KeyServices.instance;\r\n  }\r\n\r\n  private keyHandle = (e: KeyboardEvent) => {\r\n    const { registers, priorities } = this;\r\n    for (let k in registers) {\r\n      registers[k](e);\r\n    }\r\n    for (let i = 0; i < priorities.length; i++) {\r\n      if (priorities[i] && priorities[i].currentHandle) {\r\n        priorities[i].currentHandle!(e);\r\n        break;\r\n      }\r\n    }\r\n    if (!(e.keyCode > 111 && e.keyCode < 124)) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    }\r\n  };\r\n  public regHandler(id: string, keyHandle: KeyHandler) {\r\n    this.registers[id] = keyHandle;\r\n  }\r\n  public unregHandler(id: string) {\r\n    delete this.registers[id];\r\n  }\r\n  public clearRegisters() {\r\n    this.registers = {};\r\n  }\r\n\r\n  public pushHandle = (priority: number, keyHandle: KeyHandler) => {\r\n    const { priorities } = this;\r\n    if (priorities[priority]) {\r\n      priorities[priority].currentHandle = keyHandle;\r\n      priorities[priority].handles.push(keyHandle);\r\n    } else {\r\n      priorities[priority] = {\r\n        currentHandle: keyHandle,\r\n        handles: [keyHandle],\r\n      };\r\n    }\r\n  };\r\n\r\n  public popHandle = (priority: number, keyHandle: KeyHandler) => {\r\n    const { priorities } = this;\r\n    var p = priorities[priority];\r\n    if (p) {\r\n      if (keyHandle) {\r\n        const keyHandlerIndex = p.handles.indexOf(keyHandle);\r\n        if (keyHandlerIndex >= 0) {\r\n          p.handles.splice(keyHandlerIndex, 1);\r\n        }\r\n      }\r\n      p.currentHandle = p.handles.slice(-1)[0];\r\n    }\r\n  };\r\n\r\n  public switchHandle = (priority: number, keyHandle: KeyHandler) => {\r\n    const { priorities } = this;\r\n    if (priorities[priority]) {\r\n      priorities[priority].currentHandle = keyHandle;\r\n    } else {\r\n      priorities[priority] = {\r\n        currentHandle: keyHandle,\r\n        handles: [],\r\n      };\r\n    }\r\n  };\r\n\r\n  public stopHandle = (priority: number) => {\r\n    this.switchHandle(priority, this.defaultHandle);\r\n  };\r\n}\r\n"],"names":["Button","_0xce71c5","_0xf1620","BackServices","_0x4d10c2","_0x36e5e2","window","_0x53214b","_0x13bf85","_0x282b2e","backService","onPopoutFactory","_0x253e42","_0x3e8db7","_0xff0e7b","_0xbda50c","KeyServices","_0x17eb98","_0x4936b6","_0x37520b","_0x12dc62","_0x3cff39","_0x47a1e1","_0x371dae","_0x6aed15","_0x14e9d0","_0x428dc6","_0x451f56","_0x4dff25","_0x39a4f4","_0x1841db","_0x56983d","_0xb541f3","_0x3a1226","_0x1650b2","_0x2dd585","_0x47f9c0","_0x3b9f8d","_0x53b66f","_0x281557"],"mappings":"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"}